<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>obiwan.kenobi &#8212; obiwan 1.2.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Obiwan</a>
        <span class="navbar-text navbar-version pull-left"><b>1.2.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="../tutorials.html">Tutorials</a></li>
                <li><a href="../deeplearning.html">Deep Learning</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">This Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">obiwan.kenobi</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="module-obiwan.kenobi">
<span id="obiwan-kenobi"></span><h1>obiwan.kenobi<a class="headerlink" href="#module-obiwan.kenobi" title="Permalink to this headline">¶</a></h1>
<p>The Monte Carlo code that adds fake galaxiesto images from the Legacy Survey</p>
<p class="rubric">Classes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#obiwan.kenobi.BuildStamp" title="obiwan.kenobi.BuildStamp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BuildStamp</span></code></a>(tim[,&nbsp;seed,&nbsp;camera,&nbsp;gain,&nbsp;exptime])</td>
<td>Does the drawing of simulated sources on a single exposure</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#obiwan.kenobi.SimDecals" title="obiwan.kenobi.SimDecals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SimDecals</span></code></a>([dataset,&nbsp;survey_dir,&nbsp;metacat,&nbsp;…])</td>
<td>Top level object that specifying which data to run through pipeline</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#obiwan.kenobi.SimDecalsCosmos" title="obiwan.kenobi.SimDecalsCosmos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SimDecalsCosmos</span></code></a>(**kwargs)</td>
<td>Filters the CCDs to just those in the cosmos realizations</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#obiwan.kenobi.SimImage" title="obiwan.kenobi.SimImage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SimImage</span></code></a>(survey,&nbsp;t)</td>
<td>Adds simulated sources to a single exposure</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#obiwan.kenobi.SimImageCosmos" title="obiwan.kenobi.SimImageCosmos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SimImageCosmos</span></code></a>(survey,&nbsp;t)</td>
<td>Filters the CCDs to just those in the cosmos realizations</td>
</tr>
</tbody>
</table>
<p class="rubric">Functions</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#obiwan.kenobi.build_simcat" title="obiwan.kenobi.build_simcat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_simcat</span></code></a>([Samp,&nbsp;brickwcs,&nbsp;meta])</td>
<td>Creates the simulated source catalog for a given brick (not CCD).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#obiwan.kenobi.create_ith_simcat" title="obiwan.kenobi.create_ith_simcat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_ith_simcat</span></code></a>([d])</td>
<td>Write ‘simcat’ and ‘skipped_ids’ tables for a given sample of sources</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#obiwan.kenobi.create_metadata" title="obiwan.kenobi.create_metadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_metadata</span></code></a>([kwargs])</td>
<td>fits_table with configuration-like params for the simulated sources</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#obiwan.kenobi.do_ith_cleanup" title="obiwan.kenobi.do_ith_cleanup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">do_ith_cleanup</span></code></a>([d])</td>
<td>Moves all obiwan+legacypipe outputs to a new directory stucture</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#obiwan.kenobi.do_one_chunk" title="obiwan.kenobi.do_one_chunk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">do_one_chunk</span></code></a>([d])</td>
<td>Runs the legacypipe/Tractor pipeline on images with simulated sources</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">dobash</span></code>(cmd)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#obiwan.kenobi.flag_nearest_neighbors" title="obiwan.kenobi.flag_nearest_neighbors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flag_nearest_neighbors</span></code></a>(Samp[,&nbsp;radius_in_deg])</td>
<td>Returns Sample indices to keep (have &gt; dist separations) and indices to skip</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_checkpoint_fn</span></code>(outdir,&nbsp;brick,&nbsp;rowstart)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#obiwan.kenobi.get_e1_e2" title="obiwan.kenobi.get_e1_e2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_e1_e2</span></code></a>(q,&nbsp;beta)</td>
<td>Given minor to major axis ratio (q) and postion angle (beta), Returns e1,e2 tuple</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#obiwan.kenobi.get_ellip" title="obiwan.kenobi.get_ellip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_ellip</span></code></a>(q)</td>
<td>Given minor to major axis ratio (q) Returns ellipticity</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fnsuffix</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#obiwan.kenobi.get_parser" title="obiwan.kenobi.get_parser"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parser</span></code></a>()</td>
<td>return parser object, tells it what options to look for options can come from a list of strings or command line</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#obiwan.kenobi.get_runbrick_setup" title="obiwan.kenobi.get_runbrick_setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_runbrick_setup</span></code></a>(**kwargs)</td>
<td>Convert runbrick.py cmd line options into <cite>**kwargs</cite> for run_brick()</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#obiwan.kenobi.get_sample" title="obiwan.kenobi.get_sample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sample</span></code></a>(objtype,&nbsp;brick,&nbsp;randoms_db[,&nbsp;…])</td>
<td>Gets all simulated randoms for a brick from PSQl db, and applies all relevant cuts</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_skip_ids</span></code>(decals_sim_dir,&nbsp;brickname,&nbsp;objtype)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#obiwan.kenobi.get_srcimg_invvar" title="obiwan.kenobi.get_srcimg_invvar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_srcimg_invvar</span></code></a>(stamp_ivar,&nbsp;img_ivar)</td>
<td>stamp_ivar, img_ivar – galsim Image objects</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">imshow_stamp</span></code>(stamp[,&nbsp;fn,&nbsp;galsimobj])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#obiwan.kenobi.ivar_for_galaxy" title="obiwan.kenobi.ivar_for_galaxy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ivar_for_galaxy</span></code></a>(gal,&nbsp;nano2e)</td>
<td>Adds gaussian noise to perfect source</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">ivar_to_var</span></code>(ivar[,&nbsp;nano2e,&nbsp;camera])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#obiwan.kenobi.main" title="obiwan.kenobi.main"><code class="xref py py-obj docutils literal notranslate"><span class="pre">main</span></code></a>([args])</td>
<td>Main routine which parses the optional inputs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#obiwan.kenobi.noise_for_galaxy" title="obiwan.kenobi.noise_for_galaxy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">noise_for_galaxy</span></code></a>(gal,&nbsp;nano2e)</td>
<td>Returns numpy array of noise in Img count units for gal in image cnt units</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_radial_profs</span></code>(fn,&nbsp;profs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#obiwan.kenobi.ptime" title="obiwan.kenobi.ptime"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ptime</span></code></a>(text,&nbsp;t0)</td>
<td>Timer</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_dict</span></code>(fn)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">saturation_e</span></code>(camera)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#obiwan.kenobi.write_dict" title="obiwan.kenobi.write_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_dict</span></code></a>(fn,&nbsp;d)</td>
<td>d – dictionary</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="obiwan.kenobi.BuildStamp">
<em class="property">class </em><code class="descclassname">obiwan.kenobi.</code><code class="descname">BuildStamp</code><span class="sig-paren">(</span><em>tim</em>, <em>seed=0</em>, <em>camera=None</em>, <em>gain=None</em>, <em>exptime=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#BuildStamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.BuildStamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Does the drawing of simulated sources on a single exposure</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tim</strong> – Tractor Image Object for a specific CCD</li>
<li><strong>gain</strong> – gain of the CCD</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="obiwan.kenobi.BuildStamp.band">
<code class="descname">band</code><a class="headerlink" href="#obiwan.kenobi.BuildStamp.band" title="Permalink to this definition">¶</a></dt>
<dd><p>g,r,z</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.BuildStamp.camera">
<code class="descname">camera</code><a class="headerlink" href="#obiwan.kenobi.BuildStamp.camera" title="Permalink to this definition">¶</a></dt>
<dd><p>‘decam’, ‘mosaic’, ‘90prime’</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.BuildStamp.gsparams">
<code class="descname">gsparams</code><a class="headerlink" href="#obiwan.kenobi.BuildStamp.gsparams" title="Permalink to this definition">¶</a></dt>
<dd><p>galsim object that configures how accurate simulated source will be</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.BuildStamp.gsdeviate">
<code class="descname">gsdeviate</code><a class="headerlink" href="#obiwan.kenobi.BuildStamp.gsdeviate" title="Permalink to this definition">¶</a></dt>
<dd><p>galsim object that configures its random number generator</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.BuildStamp.wcs">
<code class="descname">wcs</code><a class="headerlink" href="#obiwan.kenobi.BuildStamp.wcs" title="Permalink to this definition">¶</a></dt>
<dd><p>WCS from tim</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.BuildStamp.psf">
<code class="descname">psf</code><a class="headerlink" href="#obiwan.kenobi.BuildStamp.psf" title="Permalink to this definition">¶</a></dt>
<dd><p>psf from tim</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.BuildStamp.galsim_wcs">
<code class="descname">galsim_wcs</code><a class="headerlink" href="#obiwan.kenobi.BuildStamp.galsim_wcs" title="Permalink to this definition">¶</a></dt>
<dd><p>wcs repackaged into galsim compatible object</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.BuildStamp.zpscale">
<code class="descname">zpscale</code><a class="headerlink" href="#obiwan.kenobi.BuildStamp.zpscale" title="Permalink to this definition">¶</a></dt>
<dd><p>conversion factor ‘nanomaggies’ to ‘Image units used by Legacypipe’, which
are ADU/sec for DECam and e/sec for Bass,MzLS</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.BuildStamp.nano2e">
<code class="descname">nano2e</code><a class="headerlink" href="#obiwan.kenobi.BuildStamp.nano2e" title="Permalink to this definition">¶</a></dt>
<dd><p>conversion factor ‘nanomaggies’ to ‘e-‘</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.BuildStamp.convolve_galaxy">
<code class="descname">convolve_galaxy</code><span class="sig-paren">(</span><em>gal</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#BuildStamp.convolve_galaxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.BuildStamp.convolve_galaxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolve the object with the PSF and then draw it.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.BuildStamp.elg">
<code class="descname">elg</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#BuildStamp.elg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.BuildStamp.elg" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an ELG (disk-like) galaxy.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.BuildStamp.lrg">
<code class="descname">lrg</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#BuildStamp.lrg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.BuildStamp.lrg" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an LRG just like did for ELG</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.BuildStamp.qso">
<code class="descname">qso</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#BuildStamp.qso"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.BuildStamp.qso" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a QSO just like a star</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.BuildStamp.setlocal">
<code class="descname">setlocal</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#BuildStamp.setlocal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.BuildStamp.setlocal" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the pixel positions, local wcs, local PSF.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.BuildStamp.star">
<code class="descname">star</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#BuildStamp.star"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.BuildStamp.star" title="Permalink to this definition">¶</a></dt>
<dd><p>Render a star (PSF).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="obiwan.kenobi.SimDecals">
<em class="property">class </em><code class="descclassname">obiwan.kenobi.</code><code class="descname">SimDecals</code><span class="sig-paren">(</span><em>dataset=None</em>, <em>survey_dir=None</em>, <em>metacat=None</em>, <em>simcat=None</em>, <em>output_dir=None</em>, <em>add_sim_noise=False</em>, <em>seed=0</em>, <em>image_eq_model=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#SimDecals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.SimDecals" title="Permalink to this definition">¶</a></dt>
<dd><p>Top level object that specifying which data to run through pipeline</p>
<dl class="docutils">
<dt>Same behavior as legacypipe.runs.Dr3DecalsSurvey which chooses which</dt>
<dd>CCDs to include. But this also stores all the relevant obiwan
objects</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataset</strong> – see definition in
<a class="reference external" href="https://github.com/legacysurvey/obiwan/blob/master/py/obiwan/test/end_to_end/README.md">https://github.com/legacysurvey/obiwan/blob/master/py/obiwan/test/end_to_end/README.md</a></li>
<li><strong>survey_dir</strong> – as used by legacypipe.runbrick.run_brick()
Defaults to $LEGACY_SURVEY_DIR environment variable.  Where to look for
files including calibration files, tables of CCDs and bricks, image data</li>
<li><strong>metacat</strong> – fits_table
configuration-like params for the simulated sources</li>
<li><strong>simcat</strong> – fits_table
simulated source catalog for a given brick (not CCD).</li>
<li><strong>output_dir</strong> – legacypipe’s outdir</li>
<li><strong>add_sim_noise</strong> – add Poisson noise from the simulated source to the image</li>
<li><strong>seed</strong> – for random number generators</li>
<li><strong>image_eq_model</strong> – referred to as ‘testA’
wherever add a simulated source, replace both image and invvar of the image
with that of the simulated source only</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="obiwan.kenobi.SimDecals.DR">
<code class="descname">DR</code><a class="headerlink" href="#obiwan.kenobi.SimDecals.DR" title="Permalink to this definition">¶</a></dt>
<dd><p>see above</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.SimDecals.metacat">
<code class="descname">metacat</code><a class="headerlink" href="#obiwan.kenobi.SimDecals.metacat" title="Permalink to this definition">¶</a></dt>
<dd><p>fits_table
configuration-like params for the simulated sources</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.SimDecals.simcat">
<code class="descname">simcat</code><a class="headerlink" href="#obiwan.kenobi.SimDecals.simcat" title="Permalink to this definition">¶</a></dt>
<dd><p>fits_table
simulated source catalog for a given brick (not CCD).</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.SimDecals.output_dir">
<code class="descname">output_dir</code><a class="headerlink" href="#obiwan.kenobi.SimDecals.output_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>legacypipe’s outdir</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.SimDecals.add_sim_noise">
<code class="descname">add_sim_noise</code><a class="headerlink" href="#obiwan.kenobi.SimDecals.add_sim_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>add Poisson noise from the simulated source to the image</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.SimDecals.image_eq_model">
<code class="descname">image_eq_model</code><a class="headerlink" href="#obiwan.kenobi.SimDecals.image_eq_model" title="Permalink to this definition">¶</a></dt>
<dd><p>referred to as ‘testA’
wherever add a simulated source, replace both image and invvar of the image
with that of the simulated source only</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.add_hashcode">
<code class="descname">add_hashcode</code><span class="sig-paren">(</span><em>fn</em>, <em>hashcode</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.add_hashcode" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to be called in the <em>write_output</em> routine.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.bricks_touching_radec_box">
<code class="descname">bricks_touching_radec_box</code><span class="sig-paren">(</span><em>bricks</em>, <em>ralo</em>, <em>rahi</em>, <em>declo</em>, <em>dechi</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.bricks_touching_radec_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an index vector of the bricks that touch the given RA,Dec box.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.ccd_cuts">
<code class="descname">ccd_cuts</code><span class="sig-paren">(</span><em>ccds</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.ccd_cuts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a bitmask of reasons the given <em>ccds</em> would be cut
(excluded from legacypipe processing).  These bits are defined
in LegacySurveyData.ccd_cut_bits.</p>
<p>This just delegates to the LegacySurveyImage subclasses based
on camera.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.ccds_touching_wcs">
<code class="descname">ccds_touching_wcs</code><span class="sig-paren">(</span><em>wcs</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.ccds_touching_wcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a table of the CCDs touching the given <em>wcs</em> region.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.drop_cache">
<code class="descname">drop_cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.drop_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears all cached data contained in this object.  Useful for
pickling / multiprocessing.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.filter_ccd_kd_files">
<code class="descname">filter_ccd_kd_files</code><span class="sig-paren">(</span><em>fns</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#SimDecals.filter_ccd_kd_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.SimDecals.filter_ccd_kd_files" title="Permalink to this definition">¶</a></dt>
<dd><p>see legacypipe/runs.py</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.filter_ccds_files">
<code class="descname">filter_ccds_files</code><span class="sig-paren">(</span><em>fns</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#SimDecals.filter_ccds_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.SimDecals.filter_ccds_files" title="Permalink to this definition">¶</a></dt>
<dd><p>see legacypipe/runs.py</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.find_ccds">
<code class="descname">find_ccds</code><span class="sig-paren">(</span><em>expnum=None</em>, <em>ccdname=None</em>, <em>camera=None</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.find_ccds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a table of CCDs matching the given <em>expnum</em> (exposure
number, integer), <em>ccdname</em> (string), and <em>camera</em> (string),
if given.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.find_file">
<code class="descname">find_file</code><span class="sig-paren">(</span><em>filetype</em>, <em>brick=None</em>, <em>brickpre=None</em>, <em>band='%(band)s'</em>, <em>output=False</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.find_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the filename of a Legacy Survey file.</p>
<dl class="docutils">
<dt><em>filetype</em> <span class="classifier-delimiter">:</span> <span class="classifier">string, type of file to find, including:</span></dt>
<dd>“tractor” – Tractor catalogs
“depth”   – PSF depth maps
“galdepth” – Canonical galaxy depth maps
“nexp” – number-of-exposure maps</dd>
</dl>
<p><em>brick</em> : string, brick name such as “0001p000”</p>
<p><em>output</em>: True if we are about to write this file; will use self.outdir as
the base directory rather than self.survey_dir.</p>
<p>Returns: path to the specified file (whether or not it exists).</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.get_annotated_ccds">
<code class="descname">get_annotated_ccds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.get_annotated_ccds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the annotated table of CCDs.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.get_brick">
<code class="descname">get_brick</code><span class="sig-paren">(</span><em>brickid</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.get_brick" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a brick (as one row in a table) by <em>brickid</em> (integer).</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.get_brick_by_name">
<code class="descname">get_brick_by_name</code><span class="sig-paren">(</span><em>brickname</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.get_brick_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a brick (as one row in a table) by name (string).</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.get_bricks">
<code class="descname">get_bricks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.get_bricks" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a table of bricks.  The caller owns the table.</p>
<p>For read-only purposes, see <em>get_bricks_readonly()</em>, which
uses a cached version.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.get_bricks_readonly">
<code class="descname">get_bricks_readonly</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.get_bricks_readonly" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a read-only (shared) copy of the table of bricks.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.get_calib_dir">
<code class="descname">get_calib_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.get_calib_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the directory containing calibration data.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.get_ccds">
<code class="descname">get_ccds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.get_ccds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the table of CCDs.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.get_ccds_readonly">
<code class="descname">get_ccds_readonly</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.get_ccds_readonly" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a shared copy of the table of CCDs.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.get_image_dir">
<code class="descname">get_image_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.get_image_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the directory containing image data.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.get_image_object">
<code class="descname">get_image_object</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#SimDecals.get_image_object"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.SimDecals.get_image_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a DecamImage or similar object for one row of the CCDs table.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.get_se_dir">
<code class="descname">get_se_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.get_se_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the directory containing SourceExtractor config files,
used during calibration.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.get_survey_dir">
<code class="descname">get_survey_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.get_survey_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the base LEGACY_SURVEY_DIR directory.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.photometric_ccds">
<code class="descname">photometric_ccds</code><span class="sig-paren">(</span><em>ccds</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.photometric_ccds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an index array for the members of the table “ccds” that
are photometric.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.read_intermediate_catalog">
<code class="descname">read_intermediate_catalog</code><span class="sig-paren">(</span><em>brick</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.read_intermediate_catalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the intermediate tractor catalog for the given brickname.</p>
<p><em>kwargs</em>: passed to self.find_file()</p>
<p>Returns (T, hdr, primhdr)</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.tims_touching_wcs">
<code class="descname">tims_touching_wcs</code><span class="sig-paren">(</span><em>targetwcs</em>, <em>mp</em>, <em>bands=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.tims_touching_wcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates tractor.Image objects for CCDs touching the given
<em>targetwcs</em> region.</p>
<p>mp: multiprocessing object</p>
<p>kwargs are passed to LegacySurveyImage.get_tractor_image() and
may include:</p>
<ul class="simple">
<li>gaussPsf</li>
<li>pixPsf</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecals.write_output">
<code class="descname">write_output</code><span class="sig-paren">(</span><em>filetype</em>, <em>hashsum=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecals.write_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a context manager for writing an output file; use like:</p>
<dl class="docutils">
<dt>with survey.write_output(‘ccds’, brick=brickname) as out:</dt>
<dd>ccds.writeto(out.fn, primheader=primhdr)</dd>
</dl>
<p>For FITS output, out.fits is a fitsio.FITS object.  The file
contents will actually be written in memory, and then a
sha256sum computed before the file contents are written out to
the real disk file.  The ‘out.fn’ member variable is NOT set.</p>
<dl class="docutils">
<dt>with survey.write_fits_output(‘ccds’, brick=brickname) as out:</dt>
<dd>ccds.writeto(None, fits_object=out.fits, primheader=primhdr)</dd>
</dl>
<p>Does the following on entry:
- calls self.find_file() to determine which filename to write to
- ensures the output directory exists
- appends a “.tmp” to the filename</p>
<p>Does the following on exit:
- moves the “.tmp” to the final filename (to make it atomic)
- computes the sha256sum</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="obiwan.kenobi.SimDecalsCosmos">
<em class="property">class </em><code class="descclassname">obiwan.kenobi.</code><code class="descname">SimDecalsCosmos</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#SimDecalsCosmos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters the CCDs to just those in the cosmos realizations</p>
<p>Call just like SimDecals except with additional Argument ‘subset’</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**kwargs</strong> – SimDecals args + ‘subset’</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.add_hashcode">
<code class="descname">add_hashcode</code><span class="sig-paren">(</span><em>fn</em>, <em>hashcode</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.add_hashcode" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to be called in the <em>write_output</em> routine.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.bricks_touching_radec_box">
<code class="descname">bricks_touching_radec_box</code><span class="sig-paren">(</span><em>bricks</em>, <em>ralo</em>, <em>rahi</em>, <em>declo</em>, <em>dechi</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.bricks_touching_radec_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an index vector of the bricks that touch the given RA,Dec box.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.ccd_cuts">
<code class="descname">ccd_cuts</code><span class="sig-paren">(</span><em>ccds</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.ccd_cuts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a bitmask of reasons the given <em>ccds</em> would be cut
(excluded from legacypipe processing).  These bits are defined
in LegacySurveyData.ccd_cut_bits.</p>
<p>This just delegates to the LegacySurveyImage subclasses based
on camera.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.ccds_touching_wcs">
<code class="descname">ccds_touching_wcs</code><span class="sig-paren">(</span><em>wcs</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.ccds_touching_wcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a table of the CCDs touching the given <em>wcs</em> region.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.drop_cache">
<code class="descname">drop_cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.drop_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears all cached data contained in this object.  Useful for
pickling / multiprocessing.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.filter_ccd_kd_files">
<code class="descname">filter_ccd_kd_files</code><span class="sig-paren">(</span><em>fns</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.filter_ccd_kd_files" title="Permalink to this definition">¶</a></dt>
<dd><p>see legacypipe/runs.py</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.filter_ccds_files">
<code class="descname">filter_ccds_files</code><span class="sig-paren">(</span><em>fns</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.filter_ccds_files" title="Permalink to this definition">¶</a></dt>
<dd><p>see legacypipe/runs.py</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.find_ccds">
<code class="descname">find_ccds</code><span class="sig-paren">(</span><em>expnum=None</em>, <em>ccdname=None</em>, <em>camera=None</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.find_ccds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a table of CCDs matching the given <em>expnum</em> (exposure
number, integer), <em>ccdname</em> (string), and <em>camera</em> (string),
if given.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.find_file">
<code class="descname">find_file</code><span class="sig-paren">(</span><em>filetype</em>, <em>brick=None</em>, <em>brickpre=None</em>, <em>band='%(band)s'</em>, <em>output=False</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.find_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the filename of a Legacy Survey file.</p>
<dl class="docutils">
<dt><em>filetype</em> <span class="classifier-delimiter">:</span> <span class="classifier">string, type of file to find, including:</span></dt>
<dd>“tractor” – Tractor catalogs
“depth”   – PSF depth maps
“galdepth” – Canonical galaxy depth maps
“nexp” – number-of-exposure maps</dd>
</dl>
<p><em>brick</em> : string, brick name such as “0001p000”</p>
<p><em>output</em>: True if we are about to write this file; will use self.outdir as
the base directory rather than self.survey_dir.</p>
<p>Returns: path to the specified file (whether or not it exists).</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.get_annotated_ccds">
<code class="descname">get_annotated_ccds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.get_annotated_ccds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the annotated table of CCDs.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.get_brick">
<code class="descname">get_brick</code><span class="sig-paren">(</span><em>brickid</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.get_brick" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a brick (as one row in a table) by <em>brickid</em> (integer).</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.get_brick_by_name">
<code class="descname">get_brick_by_name</code><span class="sig-paren">(</span><em>brickname</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.get_brick_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a brick (as one row in a table) by name (string).</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.get_bricks">
<code class="descname">get_bricks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.get_bricks" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a table of bricks.  The caller owns the table.</p>
<p>For read-only purposes, see <em>get_bricks_readonly()</em>, which
uses a cached version.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.get_bricks_readonly">
<code class="descname">get_bricks_readonly</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.get_bricks_readonly" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a read-only (shared) copy of the table of bricks.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.get_calib_dir">
<code class="descname">get_calib_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.get_calib_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the directory containing calibration data.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.get_ccds">
<code class="descname">get_ccds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.get_ccds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the table of CCDs.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.get_ccds_readonly">
<code class="descname">get_ccds_readonly</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.get_ccds_readonly" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a shared copy of the table of CCDs.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.get_image_dir">
<code class="descname">get_image_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.get_image_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the directory containing image data.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.get_image_object">
<code class="descname">get_image_object</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.get_image_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a DecamImage or similar object for one row of the CCDs table.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.get_se_dir">
<code class="descname">get_se_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.get_se_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the directory containing SourceExtractor config files,
used during calibration.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.get_survey_dir">
<code class="descname">get_survey_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.get_survey_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the base LEGACY_SURVEY_DIR directory.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.photometric_ccds">
<code class="descname">photometric_ccds</code><span class="sig-paren">(</span><em>ccds</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.photometric_ccds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an index array for the members of the table “ccds” that
are photometric.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.read_intermediate_catalog">
<code class="descname">read_intermediate_catalog</code><span class="sig-paren">(</span><em>brick</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.read_intermediate_catalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the intermediate tractor catalog for the given brickname.</p>
<p><em>kwargs</em>: passed to self.find_file()</p>
<p>Returns (T, hdr, primhdr)</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.tims_touching_wcs">
<code class="descname">tims_touching_wcs</code><span class="sig-paren">(</span><em>targetwcs</em>, <em>mp</em>, <em>bands=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.tims_touching_wcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates tractor.Image objects for CCDs touching the given
<em>targetwcs</em> region.</p>
<p>mp: multiprocessing object</p>
<p>kwargs are passed to LegacySurveyImage.get_tractor_image() and
may include:</p>
<ul class="simple">
<li>gaussPsf</li>
<li>pixPsf</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimDecalsCosmos.write_output">
<code class="descname">write_output</code><span class="sig-paren">(</span><em>filetype</em>, <em>hashsum=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimDecalsCosmos.write_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a context manager for writing an output file; use like:</p>
<dl class="docutils">
<dt>with survey.write_output(‘ccds’, brick=brickname) as out:</dt>
<dd>ccds.writeto(out.fn, primheader=primhdr)</dd>
</dl>
<p>For FITS output, out.fits is a fitsio.FITS object.  The file
contents will actually be written in memory, and then a
sha256sum computed before the file contents are written out to
the real disk file.  The ‘out.fn’ member variable is NOT set.</p>
<dl class="docutils">
<dt>with survey.write_fits_output(‘ccds’, brick=brickname) as out:</dt>
<dd>ccds.writeto(None, fits_object=out.fits, primheader=primhdr)</dd>
</dl>
<p>Does the following on entry:
- calls self.find_file() to determine which filename to write to
- ensures the output directory exists
- appends a “.tmp” to the filename</p>
<p>Does the following on exit:
- moves the “.tmp” to the final filename (to make it atomic)
- computes the sha256sum</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="obiwan.kenobi.SimImage">
<em class="property">class </em><code class="descclassname">obiwan.kenobi.</code><code class="descname">SimImage</code><span class="sig-paren">(</span><em>survey</em>, <em>t</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#SimImage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.SimImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds simulated sources to a single exposure</p>
<dl class="docutils">
<dt>Similar behavior as legacypipe.decam.DecamImage. Instead of</dt>
<dd>loading images specifically from DECam, this  loads images
with simulated sources added in</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>survey</strong> – SimDecals() object</li>
<li><strong>t</strong> – as used by DecamImage
a single row fits_table for a specific CCD</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="obiwan.kenobi.SimImage.inherits">
<code class="descname">inherits</code><a class="headerlink" href="#obiwan.kenobi.SimImage.inherits" title="Permalink to this definition">¶</a></dt>
<dd><p>DecamImage</p>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.SimImage.t">
<code class="descname">t</code><a class="headerlink" href="#obiwan.kenobi.SimImage.t" title="Permalink to this definition">¶</a></dt>
<dd><p>as used by DecamImage
a single row fits_table for a specific CCD</p>
</dd></dl>

<dl class="classmethod">
<dt id="obiwan.kenobi.SimImage.bad_astrometry">
<em class="property">classmethod </em><code class="descname">bad_astrometry</code><span class="sig-paren">(</span><em>survey</em>, <em>ccds</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.bad_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>IDL zeropoints have large rarms,decrms,phrms for some CP images that look fine. Legacy
zeropoints is okay for majority of these cases. False alarm? Bug in IDL zeropoints? Doing
the most conservative thing and dropping these ccds.
see email: “3/30/2017: [decam-chatter 5155] Clue to zero-point errors in dr4”</p>
</dd></dl>

<dl class="classmethod">
<dt id="obiwan.kenobi.SimImage.bad_exposures">
<em class="property">classmethod </em><code class="descname">bad_exposures</code><span class="sig-paren">(</span><em>survey</em>, <em>ccds</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.bad_exposures" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an index array for the members of the table ‘ccds’
that are good exposures (NOT flagged) in the bad_expid file.</p>
</dd></dl>

<dl class="classmethod">
<dt id="obiwan.kenobi.SimImage.ccdname_hdu_mismatch">
<em class="property">classmethod </em><code class="descname">ccdname_hdu_mismatch</code><span class="sig-paren">(</span><em>survey</em>, <em>ccds</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.ccdname_hdu_mismatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Mosaic + Bok, ccdname and hdu number must match. If not, IDL
zeropoints files has duplicated zeropoint info from one of the
other four ccds.</p>
<p>Returns a boolean array, True for CCDs with this problem.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.check_psf">
<code class="descname">check_psf</code><span class="sig-paren">(</span><em>psffn</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.check_psf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the PsfEx file is ok.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.get_cacheable_filename_variables">
<code class="descname">get_cacheable_filename_variables</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.get_cacheable_filename_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>These are names of self.X variables that are filenames that
could be cached.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.get_good_image_slice">
<code class="descname">get_good_image_slice</code><span class="sig-paren">(</span><em>extent</em>, <em>get_extent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.get_good_image_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>extent = None or extent = [x0,x1,y0,y1]</p>
<p>If <em>get_extent</em> = True, returns the new [x0,x1,y0,y1] extent.</p>
<p>Returns a new pair of slices, or <em>extent</em> if the whole image is good.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.get_good_image_subregion">
<code class="descname">get_good_image_subregion</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.get_good_image_subregion" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns x0,x1,y0,y1 of the good region of this chip,
or None if no cut should be applied to that edge; returns
(None,None,None,None) if the whole chip is good.</p>
<p>This cut is applied in addition to any masking in the mask or
invvar map.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.get_image_extent">
<code class="descname">get_image_extent</code><span class="sig-paren">(</span><em>wcs=None</em>, <em>slc=None</em>, <em>radecpoly=None</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.get_image_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns x0,x1,y0,y1,slc</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.get_image_shape">
<code class="descname">get_image_shape</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.get_image_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns image shape H,W.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.get_sky_sig1">
<code class="descname">get_sky_sig1</code><span class="sig-paren">(</span><em>splinesky=False</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.get_sky_sig1" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the per-pixel noise estimate, which (for historical
reasons) is stored in the sky model.  NOTE that this is in
image pixel counts, NOT calibrated nanomaggies.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.get_tractor_image">
<code class="descname">get_tractor_image</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#SimImage.get_tractor_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.SimImage.get_tractor_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tractor.Image (“tim”) object for this image.</p>
<p>Options describing a subimage to return:</p>
<ul class="simple">
<li><em>slc</em>: y,x slice objects</li>
<li><dl class="first docutils">
<dt><em>radecpoly</em>: numpy array, shape (N,2), RA,Dec polygon describing</dt>
<dd>bounding box to select.</dd>
</dl>
</li>
</ul>
<p>Options determining the PSF model to use:</p>
<ul class="simple">
<li><em>gaussPsf</em>: single circular Gaussian PSF based on header FWHM value.</li>
<li><em>pixPsf</em>: pixelized PsfEx model.</li>
<li><em>hybridPsf</em>: combo pixelized PsfEx + Gaussian approx.</li>
</ul>
<p>Options determining the sky model to use:</p>
<ul class="simple">
<li><em>splinesky</em>: median filter chunks of the image, then spline those.</li>
</ul>
<p>Options determining the units of the image:</p>
<ul class="simple">
<li><em>nanomaggies</em>: convert the image to be in units of NanoMaggies;
<em>tim.zpscale</em> contains the scale value the image was divided by.</li>
<li><em>subsky</em>: instantiate and subtract the initial sky model,
leaving a constant zero sky model?</li>
</ul>
</dd></dl>

<dl class="classmethod">
<dt id="obiwan.kenobi.SimImage.photometric_ccds">
<em class="property">classmethod </em><code class="descname">photometric_ccds</code><span class="sig-paren">(</span><em>survey</em>, <em>ccds</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.photometric_ccds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an index array for the members of the table ‘ccds’ that are
photometric.</p>
<p>Slightly revised recipe by DJS in Re: [decam-data 828] 2015-07-31:</p>
<ul class="simple">
<li>CCDNMATCH &gt;= 20 (At least 20 stars to determine zero-pt)</li>
<li>abs(ZPT - CCDZPT) &lt; 0.10  (Loose agreement with full-frame zero-pt)</li>
<li>ZPT within [25.08-0.50, 25.08+0.25] for g-band</li>
<li>ZPT within [25.29-0.50, 25.29+0.25] for r-band</li>
<li>ZPT within [24.92-0.50, 24.92+0.25] for z-band</li>
<li>DEC &gt; -20 (in DESI footprint)</li>
<li>EXPTIME &gt;= 30</li>
<li>CCDNUM = 31 (S7) should mask outside the region [1:1023,1:4094]</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.read_dq">
<code class="descname">read_dq</code><span class="sig-paren">(</span><em>header=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.read_dq" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the Data Quality (DQ) mask image.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.read_image">
<code class="descname">read_image</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.read_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the image file from disk.</p>
<p>The image is read from FITS file self.imgfn HDU self.hdu.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>slice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.7)"><em>slice</em></a><em>, </em><em>optional</em>) – 2-dimensional slice of the subimage to read.</li>
<li><strong>header</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Return the image header also, as tuple (image, header) ?</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>image</strong> (<em>numpy array</em>) – The image pixels.</li>
<li><strong>(image, header)</strong> (<em>(numpy array, fitsio header)</em>) – If <cite>header = True</cite>.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.read_image_header">
<code class="descname">read_image_header</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.read_image_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the FITS image header from self.imgfn HDU self.hdu.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>header</strong> – The FITS header</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">fitsio header</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.read_image_primary_header">
<code class="descname">read_image_primary_header</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.read_image_primary_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the FITS primary (HDU 0) header from self.imgfn.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>primary_header</strong> – The FITS header</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">fitsio header</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.read_invvar">
<code class="descname">read_invvar</code><span class="sig-paren">(</span><em>clip=True</em>, <em>clipThresh=0.2</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.read_invvar" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the inverse-variance (weight) map image.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.read_primary_header">
<code class="descname">read_primary_header</code><span class="sig-paren">(</span><em>fn</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.read_primary_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the FITS primary header (HDU 0) from the given filename.
This is just a faster version of fitsio.read_header(fn).</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.read_sky_model">
<code class="descname">read_sky_model</code><span class="sig-paren">(</span><em>splinesky=False</em>, <em>slc=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.read_sky_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the sky model, returning a Tractor Sky object.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImage.run_calibs">
<code class="descname">run_calibs</code><span class="sig-paren">(</span><em>psfex=True</em>, <em>sky=True</em>, <em>se=False</em>, <em>funpack=False</em>, <em>fcopy=False</em>, <em>use_mask=True</em>, <em>force=False</em>, <em>just_check=False</em>, <em>git_version=None</em>, <em>splinesky=False</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImage.run_calibs" title="Permalink to this definition">¶</a></dt>
<dd><p>Run calibration pre-processing steps.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>just_check</strong> (<em>boolean</em>) – If True, returns True if calibs need to be run.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.SimImage.shape">
<code class="descname">shape</code><a class="headerlink" href="#obiwan.kenobi.SimImage.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the full shape of the image, (H,W).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="obiwan.kenobi.SimImageCosmos">
<em class="property">class </em><code class="descclassname">obiwan.kenobi.</code><code class="descname">SimImageCosmos</code><span class="sig-paren">(</span><em>survey</em>, <em>t</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#SimImageCosmos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters the CCDs to just those in the cosmos realizations</p>
<p>Call just like SimDecals except with additional Argument ‘subset’</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**kwargs</strong> – SimDecals args + ‘subset’</td>
</tr>
</tbody>
</table>
<dl class="classmethod">
<dt id="obiwan.kenobi.SimImageCosmos.bad_astrometry">
<em class="property">classmethod </em><code class="descname">bad_astrometry</code><span class="sig-paren">(</span><em>survey</em>, <em>ccds</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.bad_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>IDL zeropoints have large rarms,decrms,phrms for some CP images that look fine. Legacy
zeropoints is okay for majority of these cases. False alarm? Bug in IDL zeropoints? Doing
the most conservative thing and dropping these ccds.
see email: “3/30/2017: [decam-chatter 5155] Clue to zero-point errors in dr4”</p>
</dd></dl>

<dl class="classmethod">
<dt id="obiwan.kenobi.SimImageCosmos.bad_exposures">
<em class="property">classmethod </em><code class="descname">bad_exposures</code><span class="sig-paren">(</span><em>survey</em>, <em>ccds</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.bad_exposures" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an index array for the members of the table ‘ccds’
that are good exposures (NOT flagged) in the bad_expid file.</p>
</dd></dl>

<dl class="classmethod">
<dt id="obiwan.kenobi.SimImageCosmos.ccdname_hdu_mismatch">
<em class="property">classmethod </em><code class="descname">ccdname_hdu_mismatch</code><span class="sig-paren">(</span><em>survey</em>, <em>ccds</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.ccdname_hdu_mismatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Mosaic + Bok, ccdname and hdu number must match. If not, IDL
zeropoints files has duplicated zeropoint info from one of the
other four ccds.</p>
<p>Returns a boolean array, True for CCDs with this problem.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.check_psf">
<code class="descname">check_psf</code><span class="sig-paren">(</span><em>psffn</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.check_psf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the PsfEx file is ok.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.get_cacheable_filename_variables">
<code class="descname">get_cacheable_filename_variables</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.get_cacheable_filename_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>These are names of self.X variables that are filenames that
could be cached.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.get_good_image_slice">
<code class="descname">get_good_image_slice</code><span class="sig-paren">(</span><em>extent</em>, <em>get_extent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.get_good_image_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>extent = None or extent = [x0,x1,y0,y1]</p>
<p>If <em>get_extent</em> = True, returns the new [x0,x1,y0,y1] extent.</p>
<p>Returns a new pair of slices, or <em>extent</em> if the whole image is good.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.get_good_image_subregion">
<code class="descname">get_good_image_subregion</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.get_good_image_subregion" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns x0,x1,y0,y1 of the good region of this chip,
or None if no cut should be applied to that edge; returns
(None,None,None,None) if the whole chip is good.</p>
<p>This cut is applied in addition to any masking in the mask or
invvar map.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.get_image_extent">
<code class="descname">get_image_extent</code><span class="sig-paren">(</span><em>wcs=None</em>, <em>slc=None</em>, <em>radecpoly=None</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.get_image_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns x0,x1,y0,y1,slc</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.get_image_shape">
<code class="descname">get_image_shape</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.get_image_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns image shape H,W.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.get_sky_sig1">
<code class="descname">get_sky_sig1</code><span class="sig-paren">(</span><em>splinesky=False</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.get_sky_sig1" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the per-pixel noise estimate, which (for historical
reasons) is stored in the sky model.  NOTE that this is in
image pixel counts, NOT calibrated nanomaggies.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.get_tractor_image">
<code class="descname">get_tractor_image</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.get_tractor_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tractor.Image (“tim”) object for this image.</p>
<p>Options describing a subimage to return:</p>
<ul class="simple">
<li><em>slc</em>: y,x slice objects</li>
<li><dl class="first docutils">
<dt><em>radecpoly</em>: numpy array, shape (N,2), RA,Dec polygon describing</dt>
<dd>bounding box to select.</dd>
</dl>
</li>
</ul>
<p>Options determining the PSF model to use:</p>
<ul class="simple">
<li><em>gaussPsf</em>: single circular Gaussian PSF based on header FWHM value.</li>
<li><em>pixPsf</em>: pixelized PsfEx model.</li>
<li><em>hybridPsf</em>: combo pixelized PsfEx + Gaussian approx.</li>
</ul>
<p>Options determining the sky model to use:</p>
<ul class="simple">
<li><em>splinesky</em>: median filter chunks of the image, then spline those.</li>
</ul>
<p>Options determining the units of the image:</p>
<ul class="simple">
<li><em>nanomaggies</em>: convert the image to be in units of NanoMaggies;
<em>tim.zpscale</em> contains the scale value the image was divided by.</li>
<li><em>subsky</em>: instantiate and subtract the initial sky model,
leaving a constant zero sky model?</li>
</ul>
</dd></dl>

<dl class="classmethod">
<dt id="obiwan.kenobi.SimImageCosmos.photometric_ccds">
<em class="property">classmethod </em><code class="descname">photometric_ccds</code><span class="sig-paren">(</span><em>survey</em>, <em>ccds</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.photometric_ccds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an index array for the members of the table ‘ccds’ that are
photometric.</p>
<p>Slightly revised recipe by DJS in Re: [decam-data 828] 2015-07-31:</p>
<ul class="simple">
<li>CCDNMATCH &gt;= 20 (At least 20 stars to determine zero-pt)</li>
<li>abs(ZPT - CCDZPT) &lt; 0.10  (Loose agreement with full-frame zero-pt)</li>
<li>ZPT within [25.08-0.50, 25.08+0.25] for g-band</li>
<li>ZPT within [25.29-0.50, 25.29+0.25] for r-band</li>
<li>ZPT within [24.92-0.50, 24.92+0.25] for z-band</li>
<li>DEC &gt; -20 (in DESI footprint)</li>
<li>EXPTIME &gt;= 30</li>
<li>CCDNUM = 31 (S7) should mask outside the region [1:1023,1:4094]</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.read_dq">
<code class="descname">read_dq</code><span class="sig-paren">(</span><em>header=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.read_dq" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the Data Quality (DQ) mask image.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.read_image">
<code class="descname">read_image</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.read_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the image file from disk.</p>
<p>The image is read from FITS file self.imgfn HDU self.hdu.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>slice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.7)"><em>slice</em></a><em>, </em><em>optional</em>) – 2-dimensional slice of the subimage to read.</li>
<li><strong>header</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Return the image header also, as tuple (image, header) ?</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>image</strong> (<em>numpy array</em>) – The image pixels.</li>
<li><strong>(image, header)</strong> (<em>(numpy array, fitsio header)</em>) – If <cite>header = True</cite>.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.read_image_header">
<code class="descname">read_image_header</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.read_image_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the FITS image header from self.imgfn HDU self.hdu.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>header</strong> – The FITS header</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">fitsio header</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.read_image_primary_header">
<code class="descname">read_image_primary_header</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.read_image_primary_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the FITS primary (HDU 0) header from self.imgfn.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>primary_header</strong> – The FITS header</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">fitsio header</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.read_invvar">
<code class="descname">read_invvar</code><span class="sig-paren">(</span><em>clip=True</em>, <em>clipThresh=0.2</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.read_invvar" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the inverse-variance (weight) map image.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.read_primary_header">
<code class="descname">read_primary_header</code><span class="sig-paren">(</span><em>fn</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.read_primary_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the FITS primary header (HDU 0) from the given filename.
This is just a faster version of fitsio.read_header(fn).</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.read_sky_model">
<code class="descname">read_sky_model</code><span class="sig-paren">(</span><em>splinesky=False</em>, <em>slc=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.read_sky_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the sky model, returning a Tractor Sky object.</p>
</dd></dl>

<dl class="method">
<dt id="obiwan.kenobi.SimImageCosmos.run_calibs">
<code class="descname">run_calibs</code><span class="sig-paren">(</span><em>psfex=True</em>, <em>sky=True</em>, <em>se=False</em>, <em>funpack=False</em>, <em>fcopy=False</em>, <em>use_mask=True</em>, <em>force=False</em>, <em>just_check=False</em>, <em>git_version=None</em>, <em>splinesky=False</em><span class="sig-paren">)</span><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.run_calibs" title="Permalink to this definition">¶</a></dt>
<dd><p>Run calibration pre-processing steps.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>just_check</strong> (<em>boolean</em>) – If True, returns True if calibs need to be run.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="obiwan.kenobi.SimImageCosmos.shape">
<code class="descname">shape</code><a class="headerlink" href="#obiwan.kenobi.SimImageCosmos.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the full shape of the image, (H,W).</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.build_simcat">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">build_simcat</code><span class="sig-paren">(</span><em>Samp=None</em>, <em>brickwcs=None</em>, <em>meta=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#build_simcat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.build_simcat" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the simulated source catalog for a given brick (not CCD).</p>
<dl class="docutils">
<dt>The WCS for the brick (not CCD) is used to convert ra,dec of source</dt>
<dd>to x,y pixel location in brickspace</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Samp</strong> – fits_table for the properties of sources in the brick
usually a subset of all sources in the brick determined by
rowstart (rs)</li>
<li><strong>brickwcs</strong> – WCS object for the brick</li>
<li><strong>meta</strong> – ‘metacat’ table
fits_table with configuration-like params for the simulated sources</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tuple of
cat:
skipping_ids:</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.create_ith_simcat">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">create_ith_simcat</code><span class="sig-paren">(</span><em>d=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#create_ith_simcat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.create_ith_simcat" title="Permalink to this definition">¶</a></dt>
<dd><p>Write ‘simcat’ and ‘skipped_ids’ tables for a given sample of sources</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>d</strong> – {‘Samp’: fits_table for the properties of sources in the brick
‘brickwcs’: WCS object for the brick
‘metacat’: fits_table with configuration params for the simulated sources
}</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Nothing, saves the ‘simcat’ and ‘skipped_ids’ tables
Adds ‘simcat’ table to dict ‘d’</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.create_metadata">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">create_metadata</code><span class="sig-paren">(</span><em>kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#create_metadata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.create_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>fits_table with configuration-like params for the simulated sources</p>
<p>TODO: Should metacat table have a rowstart column?
TODO: One metacat table per brick, instead of one per <cite>rs*</cite> directory?</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kwargs</strong> – configuration-like params for the simulated sources
{‘brickname’: which chunk of sky
‘objtype’: star,elg,lrg,qso
‘nobj’: number of simulated sources for this run
}</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Nothing
writes the ‘metacat’ fits_table to disk and stores it
in the kwargs input arg</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.do_ith_cleanup">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">do_ith_cleanup</code><span class="sig-paren">(</span><em>d=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#do_ith_cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.do_ith_cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Moves all obiwan+legacypipe outputs to a new directory stucture</p>
<dl class="docutils">
<dt>Uses rsync to move everthing, if all the rsync’s succeed then all the</dt>
<dd>original files and directories are removed</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>d</strong> – dict with keys brickname, simcat_dir</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.do_one_chunk">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">do_one_chunk</code><span class="sig-paren">(</span><em>d=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#do_one_chunk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.do_one_chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the legacypipe/Tractor pipeline on images with simulated sources</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>d</strong> – {‘args’: obiwan.kenobi.py cmd line argparse.Namespace object
‘brickname’: chunk of sky
‘metacat’: fits_table configuration params for the simulated sources
‘simcat’: fits_table simulated source catalog for a given brick (not CCD).</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">runb_brick() is ‘main’ for the legacypipe/Tractor pipeline</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Nothing, but this func end ups writing out all the obiwan results</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.flag_nearest_neighbors">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">flag_nearest_neighbors</code><span class="sig-paren">(</span><em>Samp</em>, <em>radius_in_deg=0.001388888888888889</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#flag_nearest_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.flag_nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Sample indices to keep (have &gt; dist separations) and indices to skip</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">keep,skip: indices of Samp to keep and skip</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.get_e1_e2">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">get_e1_e2</code><span class="sig-paren">(</span><em>q</em>, <em>beta</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#get_e1_e2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.get_e1_e2" title="Permalink to this definition">¶</a></dt>
<dd><p>Given minor to major axis ratio (q) and postion angle (beta), Returns e1,e2 tuple</p>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.get_ellip">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">get_ellip</code><span class="sig-paren">(</span><em>q</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#get_ellip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.get_ellip" title="Permalink to this definition">¶</a></dt>
<dd><p>Given minor to major axis ratio (q) Returns ellipticity</p>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.get_parser">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">get_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#get_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.get_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>return parser object, tells it what options to look for
options can come from a list of strings or command line</p>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.get_runbrick_setup">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">get_runbrick_setup</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#get_runbrick_setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.get_runbrick_setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert runbrick.py cmd line options into <cite>**kwargs</cite> for run_brick()</p>
<dl class="docutils">
<dt>The command line options depend on the Data Release (e.g. the</dt>
<dd>legacypipe code version. The cmd line options associated with
each DR get modified and repackaged into a dict in
legacypipe.runbrick so this converter is required to call run_brick
appropriately</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**kwargs</strong> – dict of the cmd line options to obiwan.kenobi.py</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>dict to use when calling legacypipe.runbrick.run_brick like</dt>
<dd>run_brick(brickname, survey, <cite>**dict</cite>)</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.get_sample">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">get_sample</code><span class="sig-paren">(</span><em>objtype</em>, <em>brick</em>, <em>randoms_db</em>, <em>minid=None</em>, <em>randoms_from_fits=''</em>, <em>do_skipids='no'</em>, <em>outdir=None</em>, <em>dont_sort_sampleid=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#get_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.get_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all simulated randoms for a brick from PSQl db, and applies all relevant cuts</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>objtype</strong> – elg,lrg</li>
<li><strong>brick</strong> – </li>
<li><strong>randoms_db</strong> – name of PSQL db for randoms, e.g. obiwan_elg_ra175</li>
<li><strong>minid</strong> – None, unless do_more == yes then it is an integer for the randoms id to start from</li>
<li><strong>randoms_from_fits</strong> – None or filename of fits_table to use for randoms</li>
<li><strong>do_skipids</strong> – yes or no, rerunning on all skipped randoms?</li>
<li><strong>outdir</strong> – None if do_skipids=’no’; otherwise path like $CSCRATCH/obiwan_out/elg_9deg2_ra175</li>
<li><strong>dont_sort_sampleid</strong> – False to sort sample by id</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">sample fits_table, seed</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tupe</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.get_srcimg_invvar">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">get_srcimg_invvar</code><span class="sig-paren">(</span><em>stamp_ivar</em>, <em>img_ivar</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#get_srcimg_invvar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.get_srcimg_invvar" title="Permalink to this definition">¶</a></dt>
<dd><p>stamp_ivar, img_ivar – galsim Image objects</p>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.ivar_for_galaxy">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">ivar_for_galaxy</code><span class="sig-paren">(</span><em>gal</em>, <em>nano2e</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#ivar_for_galaxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.ivar_for_galaxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds gaussian noise to perfect source</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gal</strong> – galsim.Image() for source, UNITS: nanomags</li>
<li><strong>nano2e</strong> – factor to convert to e- (gal * nano2e has units e-)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">nanomags</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">galsim.Image() of invvar for the source, UNITS</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.main">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">main</code><span class="sig-paren">(</span><em>args=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Main routine which parses the optional inputs.</p>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.noise_for_galaxy">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">noise_for_galaxy</code><span class="sig-paren">(</span><em>gal</em>, <em>nano2e</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#noise_for_galaxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.noise_for_galaxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns numpy array of noise in Img count units for gal in image cnt units</p>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.ptime">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">ptime</code><span class="sig-paren">(</span><em>text</em>, <em>t0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#ptime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.ptime" title="Permalink to this definition">¶</a></dt>
<dd><p>Timer</p>
</dd></dl>

<dl class="function">
<dt id="obiwan.kenobi.write_dict">
<code class="descclassname">obiwan.kenobi.</code><code class="descname">write_dict</code><span class="sig-paren">(</span><em>fn</em>, <em>d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/obiwan/kenobi.html#write_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#obiwan.kenobi.write_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>d – dictionary</p>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014-2018, Kaylan Burleigh, John Moustakas.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>